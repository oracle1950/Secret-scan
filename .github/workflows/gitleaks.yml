name: 🔐 Gitleaks Secret Scan

on: [push, pull_request]

jobs:
  gitleaks:
    name: Run Gitleaks Secret Scanner
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repo
      uses: actions/checkout@v3

    - name: Scan with Gitleaks
      uses: gitleaks/gitleaks-action@v2
      with:
        args: detect --source=. --report-format=sarif --report-path=gitleaks.sarif

    - name: Upload Gitleaks Report
      uses: github/codeql-action/upload-sarif@v2
      with:
        sarif_file: gitleaks.sarif
